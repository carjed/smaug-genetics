source("mod_shell.r")
pr10<-read.table("/net/bipolar/jedidiah/mutation/output/predicted/AT_GC_10kb_out.txt", header=F, stringsAsFactors=F)
head(pr10)
pr100<-read.table("/net/bipolar/jedidiah/mutation/output/predicted/AT_GC_100kb_out.txt", header=F, stringsAsFactors=F)
head(pr100)
dim(pr10)
dim(pr100)
names(pr10)<-c("CHR", "POS", "R10")
names(pr100)<-c("CHR", "POS", "R100")
prc<-merge(pr10, pr100, by=c("CHR", "POS"))
dim(prc)
head(prc)
min(prc$POS)
ggplot(prc, aes(x=R100, y=R10))+geom_point()
ggsave("10k_vs_100k_pred.png")
ggplot(prc[sample(nrow(prc), 1000000),], aes(x=R100, y=R10))+geom_point()
gc()
rm(pr10)
rm(pr100)
gc()
ggplot(prc[sample(nrow(prc), 1000000),], aes(x=R100, y=R10))+geom_point()
ggsave("10k_vs_100k_pred.png")
prc2<-prc[prc$CHR==20 & prc$POS>10000000 & prc$POS<=11000000,]
dim(prc2)
prc2$BIN<-ceiling(prc2$POS/10000)
ggplot(prc2, aes(x=R100, y=R10, colour=BIN))+geom_point()
ggsave("10k_vs_100k_col_pred.png")
ggplot(prc2, aes(x=R100, y=R10, colour=factor(BIN)))+geom_point()
ggsave("10k_vs_100k_col_pred.png")
length(unique(prc2$R100))
595479/256
savehistory("10k_vs_100k_pred.r")
prc2<-prc[prc$CHR==20 & prc$POS>10000000 & prc$POS<=10100000,]
dim(prc2)
prc2$BIN<-ceiling(prc2$POS/10000)
ggplot(prc2, aes(x=R100, y=R10, colour=factor(BIN)))+geom_point()
ggsave("10k_vs_100k_col_pred.png")
ggplot(prc2, aes(x=log(R100), y=log(R10), colour=factor(BIN)))+geom_point()
ggsave("10k_vs_100k_col_pred.png")
ggplot(prc2, aes(x=R100, y=R10, colour=factor(BIN)))+geom_point()
ggsave("10k_vs_100k_col_pred.png")
ls()
names(dat_5bp_100k)
head(dat_5bp_100k$summ)
prc3<-merge(prc2, dat_5bp_100k$summ[,c("CHR", "POS", "Sequence")], by=c("CHR", "POS"))
head(prc3)
ggplot(prc3, aes(R100, R10, colour=BIN))+geom_point()+geom_text(data=subset(prc3, Sequence=="CAATG(CATTG)"), aes(R100, R10, label=Sequence)
)
ggsave("10k_vs_100k_col2_pred.png")
dim(prc3)
dim(prc2)
ls()
head(fullfile)
dim(dat)
head(prc2)
write.table(prc2, "prc2.txt", col.names=T, row.names=F, quote=F)
dim(prc2)
prc2[15305,]
write.table(prc2, "prc2.txt", col.names=T, row.names=F, quote=F, sep="\t")
prc3<-read.table("prc3.txt", header=T, stringsAsFactors=F)
head(prc3)
ggplot(prc3, aes(R100, R10, colour=factor(BIN)))+geom_point()+geom_text(data=subset(prc3, Sequence=="CAATG(CATTG)"), aes(R100, R10, label=Sequence)
)
ggplot(prc3, aes(R100, R10, colour=factor(Bin)))+geom_point()+geom_text(data=subset(prc3, Sequence=="CAATG(CATTG)"), aes(R100, R10, label=Sequence))
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10, colour=factor(Bin)))+geom_point()+geom_text(data=subset(prc3, Sequence=="CAATG(CATTG)", Bin==1004), aes(R100, R10, label=Sequence))
ggplot(prc3, aes(R100, R10, colour=factor(Bin)))+geom_point()+geom_text(data=subset(prc3, c(Sequence=="CAATG(CATTG)", Bin==1004)), aes(R100, R10, label=Sequence))
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10, colour=factor(Bin)))+geom_point()+geom_text(data=subset(prc3, Sequence=="CAATG(CATTG)" & Bin==1004), aes(R100, R10, label=Sequence))
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10, colour=factor(Bin)))+geom_point()+geom_text(data=subset(prc3, Sequence=="CAATG(CATTG)" & Bin==1005), aes(R100, R10, label=Sequence))
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10, colour=factor(Bin)))+geom_point()+geom_text(data=subset(prc3, Sequence=="CAATC(GATTG)" & Bin==1005), aes(R100, R10, label=Sequence))
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10, colour=factor(Bin)))+geom_point()+geom_text(data=subset(prc3, substr(Sequence, 1, 4)=="CAAT" & Bin==1002), aes(R100, R10, label=Sequence))
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=subset(prc3, substr(Sequence, 1, 4)=="CAAT" & Bin==1002), aes(R100, R10, label=Sequence, size=4, alpha=0.4))
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=subset(prc3, substr(Sequence, 1, 4)=="CAAT" & Bin==1002), aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=subset(prc3, substr(Sequence, 1, 4)=="CAAT" & Bin==1004), aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=subset(prc3, Bin==1005), aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
ggsave("10k_vs_100k_col2_pred.png")
z<-prc3[1:10,"Sequence"]
z
grep("[AT][CG]", z)
grep("[AT][CG]AT", z)
grep("[AT][CG]AC", z)
grep("[A|T][C|G]AC", z)
grep("^[AT][CG]AC", z)
grep("^[AT][CG]AA", z)
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=subset(prc3, grep("^[CG][AT]AT", Sequence) & Bin==1004), aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=prc3[(grep("^[CG][AT]AT", prc3$Sequence) & Bin==1004),]), aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=prc3[(grep("^[CG][AT]AT", prc3$Sequence) & Bin==1004),], aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=prc3[(grep("^[CG][AT]AT", prc3$Sequence) & prc3$Bin==1004),], aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
z<-grep("^[CG][AT]AT", prc3$Sequence)
head(z)
y=prc3$Bin == 1004 
length(z)
length(y)
dim(prc3)
head(prc3)
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=prc3[(grep("^[CG][AT]AT", prc3$Sequence) && prc3$Bin==1004),], aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
z1<-prc3[(grep("^[CG][AT]AT", prc3$Sequence) && prc3$Bin==1004),]
dim(z1)
z1<-prc3[grep("^[CG][AT]AT", prc3$Sequence),]
dim(z1)
head(z1)
dim(z1[z1$Bin==1004,])
z1<-prc3[grep("^[CG][AT]AT", prc3$Sequence) & prc3$Bin==1004,]
z1<-prc3[prc3$Bin==1004 & grep("^[CG][AT]AT", prc3$Sequence),]
z1<-prc3[grep("^[CG][AT]AT", prc3$Sequence),]
z1<-prc3[prc3$Bin==1004 & grep("^[CG][AT]AT", prc3$Sequence, value=T),]
z1<-prc3[(grep("^[CG][AT]AT", prc3$Sequence, value=TRUE) & prc3$Bin==1004),]
z1<-prc3[(prc3$Sequence %in% grep("^[CG][AT]AT", prc3$Sequence, value=TRUE) & prc3$Bin==1004),]
dim(z1)
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=prc3[(prc3$Sequence %in% grep("^[CG][AT]AT", prc3$Sequence, value=TRUE) & prc3$Bin==1004),]
, aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=prc3[(prc3$Sequence %in% grep("^[CG]TAT", prc3$Sequence, value=TRUE) & prc3$Bin==1004),],  aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
ggsave("10k_vs_100k_col2_pred.png")
ggplot(prc3, aes(R100, R10))+geom_point(aes(colour=factor(Bin)))+geom_text(data=prc3[(prc3$Sequence %in% grep("^[CG]TAT", prc3$Sequence, value=TRUE) & prc3$Bin==1005),],  aes(R100, R10, label=Sequence, size=4, alpha=0.4), hjust=0, vjust=0)
ggsave("10k_vs_100k_col2_pred.png")
savehistory("10k_vs_100k_pred.r")
